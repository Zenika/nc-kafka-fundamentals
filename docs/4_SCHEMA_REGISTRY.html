<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lab04 - Schema Registry | Workshop Kafka fundamentals</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Workshop Kafka fundamentals">
    
    <link rel="preload" href="/nc-kafka-fundamentals/assets/css/0.styles.c4e8639d.css" as="style"><link rel="preload" href="/nc-kafka-fundamentals/assets/js/app.8d4b1e30.js" as="script"><link rel="preload" href="/nc-kafka-fundamentals/assets/js/2.2ca81853.js" as="script"><link rel="preload" href="/nc-kafka-fundamentals/assets/js/12.c8221e1e.js" as="script"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/10.6175fc32.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/11.85089473.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/13.f168b2ff.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/14.1e6d5809.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/15.d2ffa686.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/16.11fe726e.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/3.57036479.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/4.e7c996f5.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/5.6eff8140.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/6.17d5dd20.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/7.1eba257d.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/8.800b581c.js"><link rel="prefetch" href="/nc-kafka-fundamentals/assets/js/9.60b7c2cf.js">
    <link rel="stylesheet" href="/nc-kafka-fundamentals/assets/css/0.styles.c4e8639d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nc-kafka-fundamentals/" class="home-link router-link-active"><img src="/nc-kafka-fundamentals/kafka-logo.png" alt="Workshop Kafka fundamentals" class="logo"> <span class="site-name can-hide">Workshop Kafka fundamentals</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/Zenika/nc-kafka-fundamentals" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/Zenika/nc-kafka-fundamentals" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/nc-kafka-fundamentals/0_SETUP.html" class="sidebar-link">Présentation et Installation</a></li><li><a href="/nc-kafka-fundamentals/1_GETTING_STARTED.html" class="sidebar-link">Lab01 - Découverte Kafka, Zookeeper et AKHQ</a></li><li><a href="/nc-kafka-fundamentals/2_PRODUCER.html" class="sidebar-link">Lab02 - Producer</a></li><li><a href="/nc-kafka-fundamentals/3_CONSUMER.html" class="sidebar-link">Lab03 - Consumer</a></li><li><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html" aria-current="page" class="active sidebar-link">Lab04 - Schema Registry</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html#rappel" class="sidebar-link">Rappel</a></li><li class="sidebar-sub-header"><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html#le-schema-registry-de-confluent" class="sidebar-link">Le Schema Registry de Confluent</a></li><li class="sidebar-sub-header"><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html#preparer-le-projet-et-le-topic-kafka" class="sidebar-link">Préparer le projet et le topic Kafka</a></li><li class="sidebar-sub-header"><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html#un-peu-de-code" class="sidebar-link">Un peu de code</a></li><li class="sidebar-sub-header"><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html#packager-votre-application-avec-docker" class="sidebar-link">Packager votre application avec Docker</a></li><li class="sidebar-sub-header"><a href="/nc-kafka-fundamentals/4_SCHEMA_REGISTRY.html#solution" class="sidebar-link">Solution</a></li></ul></li><li><a href="/nc-kafka-fundamentals/5_STREAMS.html" class="sidebar-link">Lab05 - Kafka Streams</a></li><li><a href="/nc-kafka-fundamentals/6_CONNECT.html" class="sidebar-link">Lab06 - Kafka connect</a></li><li><a href="/nc-kafka-fundamentals/7_REQUEST_REPLY.html" class="sidebar-link">Lab07 - Request-Reply</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lab04-schema-registry"><a href="#lab04-schema-registry" class="header-anchor">#</a> Lab04 - Schema Registry</h1> <h2 id="rappel"><a href="#rappel" class="header-anchor">#</a> Rappel</h2> <p style="text-align:center;"><img src="lab04.png" alt="lab04"></p> <p style="text-align:center;"><img src="lab04.bis.png" alt="lab04-bis"></p> <h2 id="le-schema-registry-de-confluent"><a href="#le-schema-registry-de-confluent" class="header-anchor">#</a> Le Schema Registry de Confluent</h2> <p>Schema Registry est une couche de stockage distribuée pour les schémas qui utilise Kafka comme mécanisme de stockage
sous-jacent.
<img src="schema-registry-and-kafka.png" alt="schema-registry-and-kafka.png"></p> <p>Schema Registry est sous licence Confluent Community License.</p> <p>Le repository Github: <a href="https://github.com/confluentinc/schema-registry" target="_blank" rel="noopener noreferrer">https://github.com/confluentinc/schema-registry<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
.</p> <p>La documentation officielle de
confluent: <a href="https://docs.confluent.io/platform/current/schema-registry/index.html" target="_blank" rel="noopener noreferrer">https://docs.confluent.io/platform/current/schema-registry/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
.</p> <h2 id="preparer-le-projet-et-le-topic-kafka"><a href="#preparer-le-projet-et-le-topic-kafka" class="header-anchor">#</a> Préparer le projet et le topic Kafka</h2> <ul><li><p>⚠️ Checkout de la branche <code>step04</code> ⚠️.</p></li> <li><p>Se placer dans le repertoire <code>Lab04-avro</code></p></li> <li><p>Demarrer le conteneur Schema registry.</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>docker-compose -f docker-compose-schema.yml up -d
</code></pre></div><h3 id="le-topic-kafka"><a href="#le-topic-kafka" class="header-anchor">#</a> Le topic Kafka</h3> <ul><li><p>Au sein de ce lab nous utilisons <a href="https://spring.io/projects/spring-kafka" target="_blank" rel="noopener noreferrer">spring-kafka<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pour dialoguer avec Kafka au
sein de l'écosystème Spring Boot.</p></li> <li><p>Spring Kafka fourni des composants qui permettent de vous &quot;faciliter la vie&quot;, il permet de facilement créér des topics
au sein de votre application:
<a href="https://docs.spring.io/spring-kafka/reference/html/#configuring-topics" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-kafka/reference/html/#configuring-topics<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Le bean <code>NewTopic</code> provoque la création du topic sur le broker; il n'est pas nécessaire si le topic existe déjà.</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token class-name">NewTopic</span> <span class="token function">schemaAvroTopic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">TopicBuilder</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitions</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replicas</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>⚠️ Spring Kafka utilise l'API admin du cluster pour réaliser cette opération de création de topic. Même si vous
specifier <code>KAFKA_AUTO_CREATE_TOPICS_ENABLE: 'false'</code>, le paramétrage d'un bean <code>KafkaAdmin</code> permet de manipuler l'API
admin.</li></ul> <h2 id="un-peu-de-code"><a href="#un-peu-de-code" class="header-anchor">#</a> Un peu de code</h2> <ul><li><p>Avro a un modèle de données de type JSON, mais peut être représenté en tant que JSON ou sous une forme binaire
compacte. Il est livré avec un langage de description de schéma très sophistiqué qui décrit les données.</p> <ol><li>Direct Mapping vers et depuis JSON</li> <li>Il dispose d'un format très compact.</li> <li>C'est très rapide.</li> <li>Vous pouvez générer des objets Java pour des événements Kafka, mais il ne nécessite pas de génération de code
afin que les outils puissent être écrits de manière générique pour tout flux de données.</li> <li>Il dispose d'un langage de schéma riche et extensible défini en JSON.</li> <li>Il dispose de la meilleure notion de compatibilité pour faire évoluer vos données/schémas dans le temps.</li></ol></li> <li><p>Pour plus d'informations sur l'usage
d'Avro: <a href="https://www.confluent.fr/blog/avro-kafka-data/" target="_blank" rel="noopener noreferrer">https://www.confluent.fr/blog/avro-kafka-data/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Explorez le découpage projet</p> <ul><li><code>consumer</code></li> <li><code>producer</code></li> <li><code>src/main/avro</code></li></ul></li> <li><p>Au sein de ce projet <code>Lab04-avro</code> nous utilisons un plugin maven nous permettant de générer nos entités métiers
d'événements Kafka.</p></li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.avro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>avro-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.10.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">&gt;</span></span>process-sources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>schema<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sourceDirectory</span><span class="token punctuation">&gt;</span></span>${project.basedir}/src/main/avro/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sourceDirectory</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>outputDirectory</span><span class="token punctuation">&gt;</span></span>${project.basedir}/target/generated-sources/avro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>outputDirectory</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>Pour générer les entités, il est nécessaire d'éxecuter la phase maven <code>compile</code> qui appliquera le <code>process-sources</code>.</li></ul> <blockquote><p>Se placer dans le bon répertoire <code>Lab04-avro</code></p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>./mvnw clean compile`
</code></pre></div><ul><li><p>Observez les POJO générés cf. <code>target/generated-sources/avro</code></p></li> <li><p>Maintenant vous pouvez utiliser directement des objets java dans votre code, pas besoin de passer par un <code>String</code>,
vous pouvez exploiter des objets complexes.</p></li></ul> <h3 id="partie-producer"><a href="#partie-producer" class="header-anchor">#</a> Partie <code>Producer</code></h3> <blockquote><p>La classe VehiclePositionProducer.java</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ProducerFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PositionKey</span><span class="token punctuation">,</span> <span class="token class-name">PositionValue</span><span class="token punctuation">&gt;</span></span> producerFactory<span class="token punctuation">;</span>
</code></pre></div><ul><li>Et surtout paramétrer des clés complexes pour vos <code>Record</code>:</li></ul> <blockquote><p>La classe Subscriber.java</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">PositionValue</span> value <span class="token operator">=</span> <span class="token function">getPositionValue</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">PositionKey</span> key <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PositionKey</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PositionKey</span><span class="token punctuation">,</span> <span class="token class-name">PositionValue</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">record</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>kafkaTopic<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">record</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="partie-consummer"><a href="#partie-consummer" class="header-anchor">#</a> Partie <code>Consummer</code></h3> <blockquote><p>La classe KafkaRestConsumer.java</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PositionKey</span><span class="token punctuation">,</span> <span class="token class-name">PositionValue</span><span class="token punctuation">&gt;</span></span> consumer <span class="token operator">=</span> kafkaConsumerFactory<span class="token punctuation">.</span><span class="token function">createConsumer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//...</span>
<span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PositionKey</span><span class="token punctuation">,</span> <span class="token class-name">PositionValue</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="demarrer-votre-application-en-local"><a href="#demarrer-votre-application-en-local" class="header-anchor">#</a> Démarrer votre application en local</h3> <p>-Il s'agit d'un projet Maven qui dispose d'un wrapper <code>mvnw</code> et du plugin <code>spring-boot-maven-plugin</code>, vous pouvez
démarrer votre application spring en local à l'aide de la commande suivante:</p> <blockquote><p>Se placer dans le bon répertoire <code>Lab04-avro</code></p></blockquote> <div class="language-shell extra-class"><pre class="language-shell"><code>./mvnw spring-boot:run
</code></pre></div><ul><li>Visualiser la consommation des messages sur l'url suivante: <a href="http://localhost:8092" target="_blank" rel="noopener noreferrer">http://localhost:8092<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><ul><li>Que voyez-vous sur l'IHM ?</li> <li>Observez les schemas AKHQ <a href="http://localhost:8080/ui/server/schema" target="_blank" rel="noopener noreferrer">http://akhq:8080/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ?</li> <li>Ou sont stockés les schémas ?</li></ul></blockquote> <h2 id="packager-votre-application-avec-docker"><a href="#packager-votre-application-avec-docker" class="header-anchor">#</a> Packager votre application avec Docker</h2> <ul><li>Pour builder et démarrer le conteneur</li></ul> <blockquote><p>Se placer dans le bon répertoire <code>Lab04-avro</code></p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>docker build -t vp-avro-producer-consumer <span class="token builtin class-name">.</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code>docker run --name vp-avro-producer-consumer --network<span class="token operator">=</span>tz-kafka-network -p <span class="token number">8092</span>:8092 -d vp-avro-producer-consumer
</code></pre></div><h2 id="solution"><a href="#solution" class="header-anchor">#</a> Solution</h2> <p>Vous vous doutez que pour disposer des solutions de la <code>step04</code>, il vous suffit de️ checkout la branche <code>step05</code> 😊</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/nc-kafka-fundamentals/3_CONSUMER.html" class="prev">
        Lab03 - Consumer
      </a></span> <span class="next"><a href="/nc-kafka-fundamentals/5_STREAMS.html">
        Lab05 - Kafka Streams
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/nc-kafka-fundamentals/assets/js/app.8d4b1e30.js" defer></script><script src="/nc-kafka-fundamentals/assets/js/2.2ca81853.js" defer></script><script src="/nc-kafka-fundamentals/assets/js/12.c8221e1e.js" defer></script>
  </body>
</html>
