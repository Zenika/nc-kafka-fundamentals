(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{368:function(e,a,t){"use strict";t.r(a);var s=t(44),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"lab05-kafka-streams"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lab05-kafka-streams"}},[e._v("#")]),e._v(" Lab05 - Kafka Streams")]),e._v(" "),t("h2",{attrs:{id:"rappel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rappel"}},[e._v("#")]),e._v(" Rappel")]),e._v(" "),t("p",{staticStyle:{"text-align":"center"}},[t("img",{attrs:{src:"lab05.png",alt:"lab05"}})]),e._v(" "),t("h2",{attrs:{id:"kafka-streams"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafka-streams"}},[e._v("#")]),e._v(" Kafka Streams")]),e._v(" "),t("ul",[t("li",[e._v("Kafka Streams est une API pour la cr√©ation d'applications et de microservices, o√π les donn√©es d'entr√©e et de sortie\nsont stock√©es dans des clusters Kafka.")])]),e._v(" "),t("p",[t("img",{attrs:{src:"kk-streams.png",alt:"kk-streams.png"}})]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Kafka Streams est sous licence Apache 2.0")])]),e._v(" "),t("li",[t("p",[e._v("Kafka Streams est la biblioth√®que de stream processing propos√©e par Apache Kafka. Elle permet la transformation √† la\nvol√© de flux continus. Avec cette biblioth√®que il est possible d‚Äôatteindre de tr√®s faibles latences. Elle permet tous\ntypes de transformations (filtres, aggr√©gations, jointures etc).")])])]),e._v(" "),t("blockquote",[t("ul",[t("li",[e._v("√âlastique, hautement √©volutif, tol√©rant aux pannes.")]),e._v(" "),t("li",[e._v("D√©ployer sur des conteneurs, des machines virtuelles, du bare metal, du cloud etc.")]),e._v(" "),t("li",[e._v("√âgalement viable pour les cas d'utilisation petits, moyens et grands.")]),e._v(" "),t("li",[e._v("Enti√®rement int√©gr√© avec Kafka-Security.")]),e._v(" "),t("li",[e._v("√âcrire des applications Java standard.")]),e._v(" "),t("li",[e._v('S√©mantique "Exactly-Once".')]),e._v(" "),t("li",[e._v("Aucune brique externe requise.")])])]),e._v(" "),t("h2",{attrs:{id:"preparer-le-projet-et-le-topic-kafka"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#preparer-le-projet-et-le-topic-kafka"}},[e._v("#")]),e._v(" Pr√©parer le projet et le topic Kafka")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("‚ö†Ô∏è Checkout de la branche "),t("code",[e._v("step05")]),e._v(" ‚ö†Ô∏è.")])]),e._v(" "),t("li",[t("p",[e._v("Se placer dans le repertoire "),t("code",[e._v("Lab05-kstream")])])]),e._v(" "),t("li",[t("p",[e._v("Explorer le projet Spring Boot "),t("code",[e._v("Lab05-kstream")])]),e._v(" "),t("ul",[t("li",[e._v("La configuration pr√©sente dans le fichier "),t("code",[e._v("application.properties")])]),e._v(" "),t("li",[e._v("Le "),t("code",[e._v("StreamBuilder")])])])]),e._v(" "),t("li",[t("p",[e._v("Cr√©er les topics "),t("code",[e._v("vehicle-positions-filtered-avro")]),e._v(" & "),t("code",[e._v("vehicle-positions-light-avro")]),e._v(" en CLI.")])])]),e._v(" "),t("blockquote",[t("p",[e._v("‚ö†Ô∏è Penser √† √™tre pr√©sent dans le conteneur "),t("code",[e._v("tools")])])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("kafka-topics --if-not-exists --bootstrap-server kafka:9092 --create --topic vehicle-positions-filtered-avro --replication-factor "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" --partitions "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\nkafka-topics --if-not-exists --bootstrap-server kafka:9092 --create --topic vehicle-positions-light-avro --replication-factor "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" --partitions "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n")])])]),t("h2",{attrs:{id:"un-peu-de-code"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#un-peu-de-code"}},[e._v("#")]),e._v(" Un peu de code")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Au sein de la classe "),t("code",[e._v("VPKStream")]),e._v(" nous souhaitons r√©aliser deux op√©rations via des Streams :")])]),e._v(" "),t("li",[t("p",[e._v("Compl√©ter le code dans la m√©thode "),t("code",[e._v("startFilterStream()")]),e._v(" pour r√©aliser un filtrage des records sur le champ "),t("strong",[e._v("oper")]),e._v("\nafin de ne conserver que les records sp√©cifiques √† l'op√©rateur 22 (Nobina Finland Oy).\nUtiliser le topic de sortie suivant "),t("code",[e._v("vehicle-positions-filtered-avro")]),e._v(".\nCe dernier ne doit contenir que des records sp√©cifiques √† l'op√©rateur 22.")])]),e._v(" "),t("li",[t("p",[e._v("Compl√©ter le code dans la m√©thode "),t("code",[e._v("startLightMappingStream()")]),e._v(" pour r√©aliser un mapping des donn√©es\nsur le type "),t("code",[e._v("LightPositionValue")]),e._v("\nUtiliser le topic de sortie suivant "),t("code",[e._v("vehicle-positions-filtered-avro")]),e._v(".\nCe dernier ne doit contenir que des records sp√©cifiques √† l'op√©rateur 22.")])]),e._v(" "),t("li",[t("p",[e._v("N'h√©sitez pas √† parcourir l'ensemble des m√©thodes pr√©sentes dans la classe "),t("code",[e._v("KStream")]),e._v(" afin d'avoir une vue d'ensemble\ndes possibilit√©s offertes par cette derni√®re.")])]),e._v(" "),t("li",[t("p",[e._v("Au d√©marrage de l'application les topology de vos streams sont affich√©s dans les logs, vous pouvez utiliser\nla web app suivante "),t("a",{attrs:{href:"https://zz85.github.io/kafka-streams-viz/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://zz85.github.io/kafka-streams-viz/"),t("OutboundLink")],1),e._v(") afin de simplfier leurs repr√©sentations.")])])]),e._v(" "),t("blockquote",[t("p",[e._v("Topology du stream d√©crit dans la m√©thode "),t("code",[e._v("startFilterStream()")])])]),e._v(" "),t("div",{staticClass:"language-console extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("com.zenika.kafka.kstream.VPKStream       : Topologies:\nSub-topology: 0\nSource: KSTREAM-SOURCE-0000000000 (topics: vehicle-positions-avro)\n--\x3e KSTREAM-FILTER-0000000001\nProcessor: KSTREAM-FILTER-0000000001 (stores: [])\n--\x3e KSTREAM-SINK-0000000002\n<-- KSTREAM-SOURCE-0000000000\nSink: KSTREAM-SINK-0000000002 (topic: vehicle-positions-filtered-avro)\n<-- KSTREAM-FILTER-0000000001\n")])])]),t("blockquote",[t("p",[e._v("Topology du stream d√©crit dans la m√©thode "),t("code",[e._v("startLightMappingStream()")])])]),e._v(" "),t("div",{staticClass:"language-console extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("com.zenika.kafka.kstream.VPKStream       : Topologies:\nSub-topology: 0\nSource: KSTREAM-SOURCE-0000000000 (topics: vehicle-positions-avro)\n--\x3e KSTREAM-MAPVALUES-0000000001\nProcessor: KSTREAM-MAPVALUES-0000000001 (stores: [])\n--\x3e KSTREAM-SINK-0000000002\n<-- KSTREAM-SOURCE-0000000000\nSink: KSTREAM-SINK-0000000002 (topic: vehicle-positions-light-avro)\n<-- KSTREAM-MAPVALUES-0000000001\n")])])]),t("h3",{attrs:{id:"demarrer-votre-application-en-local"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#demarrer-votre-application-en-local"}},[e._v("#")]),e._v(" D√©marrer votre application en local")]),e._v(" "),t("ul",[t("li",[e._v("Il s'agit d'un projet Maven qui dispose d'un wrapper "),t("code",[e._v("mvnw")]),e._v(" et du plugin "),t("code",[e._v("spring-boot-maven-plugin")]),e._v(", vous pouvez\nd√©marrer votre application spring en local √† l'aide de la commande suivante:")])]),e._v(" "),t("blockquote",[t("p",[e._v("Se placer dans le bon r√©pertoire "),t("code",[e._v("Lab05-kstream")])])]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("./mvnw spring-boot:run\n")])])]),t("ul",[t("li",[e._v("Visualiser les modifications des records dans AKHQ: "),t("a",{attrs:{href:"http://akhq:8080/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://akhq:8080/"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"packager-votre-application-avec-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#packager-votre-application-avec-docker"}},[e._v("#")]),e._v(" Packager votre application avec Docker")]),e._v(" "),t("ul",[t("li",[e._v("Pour builder et d√©marrer le conteneur")])]),e._v(" "),t("blockquote",[t("p",[e._v("Se placer dans le bon r√©pertoire "),t("code",[e._v("Lab05-kstream")])])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("docker build -t vp-kstream "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("docker run --name vp-kstream --network"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("tz-kafka-network -d vp-kstream\n")])])]),t("h2",{attrs:{id:"solution"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solution"}},[e._v("#")]),e._v(" Solution")]),e._v(" "),t("p",[e._v("Vous vous doutez que pour disposer des solutions de la "),t("code",[e._v("step05")]),e._v(", il vous suffit deÔ∏è checkout la branche "),t("code",[e._v("step06")]),e._v(" üòä")])])}),[],!1,null,null,null);a.default=r.exports}}]);